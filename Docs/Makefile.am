
SUBDIRS = pages Examples images

EXTRA_DIST = \
             makefile.mak \
             quantlib.css \
             quantlib.doxy \
             quantlibfooter.html \
             quantlibfooteronline.html \
             quantlibheader.html \
             quantlibheader.tex \
             userman.tex \
             README.txt

TEX_PARAMETERS = buf_size=500000 pool_size=768000 extra_mem_top=512000 extra_mem_bot=512000 max_strings=45000 hash_extra=10000 save_size=8000

BASEPATH = @abs_top_srcdir@

docs-all: docs-ps docs-pdf
docs-html: docs-html-offline
docs-html-offline:
	$(SED) -e "s/_MAN           = NO/_MAN           = YES/" \
           -e "s|ql_basepath|${BASEPATH}/|" \
	       quantlib.doxy > .quantlib.doxy
	$(DOXYGEN) .quantlib.doxy
	rm .quantlib.doxy
	cp images/*.jpg html
	cp images/*.png html
	cp images/*.eps latex
	cp images/*.pdf latex
docs-html-online:
	$(SED) -e "s/quantlibfooter.html/quantlibfooteronline.html/" \
	       -e "s/_MAN           = NO/_MAN           = YES/" \
           -e "s|ql_basepath|${BASEPATH}/|" \
	       quantlib.doxy > .quantlib.doxy
	$(DOXYGEN) .quantlib.doxy
	rm .quantlib.doxy
	cp images/*.jpg html
	cp images/*.png html
	cp images/*.eps latex
	cp images/*.pdf latex
docs-pdf: tex-files
	cd latex && $(TEX_PARAMETERS) $(PDFLATEX) refman
	cd latex && $(MAKEINDEX) refman
	cd latex && $(TEX_PARAMETERS) $(PDFLATEX) refman
docs-ps: tex-files
	cd latex && $(TEX_PARAMETERS) $(LATEX) refman
	cd latex && $(MAKEINDEX) refman
	cd latex && $(TEX_PARAMETERS) $(LATEX) refman
	cd latex && $(DVIPS) refman
docs-man: docs-html
docs-clean:
	rm -Rf man
	rm -Rf html
	rm -Rf latex

tex-files: docs-html
	cp userman.tex latex/userman.tex
	mv latex/refman.tex .refman.tex
	$(SED) -e "/Page Index/d" \
           -e "/input{pages}/d" \
           -e "/Page Documentation/d" \
           -e "/input{group}/d" \
           -e "/include{coreclasses}/d" \
           -e "/include{currencies}/d" \
           -e "/include{datetime}/d" \
           -e "/include{findiff}/d" \
           -e "/include{fixedincome}/d" \
           -e "/include{history}/d" \
           -e "/include{index}/d" \
           -e "/include{install}/d" \
           -e "/include{instruments}/d" \
           -e "/include{lattices}/d" \
           -e "/include{license}/d" \
           -e "/include{math}/d" \
           -e "/include{mcarlo}/d" \
           -e "/include{overview}/d" \
           -e "/include{patterns}/d" \
           -e "/include{platforms}/d" \
           -e "/include{resources}/d" \
           -e "/include{termstructures}/d" \
           -e "/include{usage}/d" \
           -e "/include{utilities}/d" \
           -e "/include{where}/d" \
           -e "/include{todo}/d" \
           -e "s/ple Documentation}/ple Documentation}\\\\label{exchap}/" \
	       .refman.tex > latex/refman.tex
	rm -f .refman.tex
	mv latex/deprecated.tex .deprecated.tex
	$(SED) -e "s/section/chapter/" .deprecated.tex > latex/deprecated.tex
	rm -f .deprecated.tex
	mv latex/unstable.tex .unstable.tex
	$(SED) -e "s/section/chapter/" .unstable.tex > latex/unstable.tex
	rm -f .unstable.tex

